### Variables
@apiVersion = /api/admin

###
### ============================================
### PASSWORD RESET ENDPOINTS
### ============================================
###

### Forgot Password - Request Reset Code
# @name forgotPassword
POST {{bevalk_base_url}}{{apiVersion}}/auth/forgot-password
Content-Type: application/json
Accept: application/json

{
  "email": "user@example.com"
}

> {%
    client.log("Password reset code sent to email");
%}

### Forgot Password - Invalid Email (Non-existent)
POST {{bevalk_base_url}}{{apiVersion}}/auth/forgot-password
Content-Type: application/json
Accept: application/json

{
  "email": "nonexistent@example.com"
}

### Forgot Password - Invalid Email Format
POST {{bevalk_base_url}}{{apiVersion}}/auth/forgot-password
Content-Type: application/json
Accept: application/json

{
  "email": "invalid-email-format"
}

### Verify Password Reset Code - Success
# Replace {code} with the 6-digit code received via email
POST {{bevalk_base_url}}{{apiVersion}}/auth/verify-password-reset-code
Content-Type: application/json
Accept: application/json

{
  "email": "user@example.com",
  "code": 123456
}

### Verify Password Reset Code - Invalid Code
POST {{bevalk_base_url}}{{apiVersion}}/auth/verify-password-reset-code
Content-Type: application/json
Accept: application/json

{
  "email": "user@example.com",
  "code": 999999
}

### Verify Password Reset Code - Expired Code
POST {{bevalk_base_url}}{{apiVersion}}/auth/verify-password-reset-code
Content-Type: application/json
Accept: application/json

{
  "email": "user@example.com",
  "code": 123456
}

### Verify Password Reset Code - Invalid Email
POST {{bevalk_base_url}}{{apiVersion}}/auth/verify-password-reset-code
Content-Type: application/json
Accept: application/json

{
  "email": "nonexistent@example.com",
  "code": 123456
}

### Reset Password - Success
# Replace {code} with the 6-digit code received via email
# The password must meet these requirements:
# - Minimum 12 characters
# - At least one letter
# - Mixed case (upper and lower)
# - At least one number
# - At least one symbol
PUT {{bevalk_base_url}}{{apiVersion}}/auth/reset-password
Content-Type: application/json
Accept: application/json

{
  "code": 123456,
  "email": "user@example.com",
  "password": "NewPassword123!@#",
  "password_confirmation": "NewPassword123!@#"
}

### Reset Password - Invalid Code
PUT {{bevalk_base_url}}{{apiVersion}}/auth/reset-password
Content-Type: application/json
Accept: application/json

{
  "code": 999999,
  "email": "user@example.com",
  "password": "NewPassword123!@#",
  "password_confirmation": "NewPassword123!@#"
}

### Reset Password - Password Mismatch
PUT {{bevalk_base_url}}{{apiVersion}}/auth/reset-password
Content-Type: application/json
Accept: application/json

{
  "code": 123456,
  "email": "user@example.com",
  "password": "NewPassword123!@#",
  "password_confirmation": "DifferentPassword123!@#"
}

### Reset Password - Weak Password (Too Short)
PUT {{bevalk_base_url}}{{apiVersion}}/auth/reset-password
Content-Type: application/json
Accept: application/json

{
  "code": 123456,
  "email": "user@example.com",
  "password": "Short1!",
  "password_confirmation": "Short1!"
}

### Reset Password - Weak Password (No Symbols)
PUT {{bevalk_base_url}}{{apiVersion}}/auth/reset-password
Content-Type: application/json
Accept: application/json

{
  "code": 123456,
  "email": "user@example.com",
  "password": "NewPassword123",
  "password_confirmation": "NewPassword123"
}

### Reset Password - Invalid Email
PUT {{bevalk_base_url}}{{apiVersion}}/auth/reset-password
Content-Type: application/json
Accept: application/json

{
  "code": 123456,
  "email": "nonexistent@example.com",
  "password": "NewPassword123!@#",
  "password_confirmation": "NewPassword123!@#"
}

